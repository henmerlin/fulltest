<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/recursos/template/template.xhtml">

	<ui:define name="tituloPagina">
		 Início
	</ui:define>
	<ui:define name="tituloPrincipal">
		<i class="fa fa-wrench"> </i> Atendimento</ui:define>
	<ui:define name="tituloSecundario"></ui:define>

	<ui:define name="botoesAcao"></ui:define>

	<ui:define name="eventos">
		<f:metadata>
			<f:event listener="#{loginBean.validarLogin()}" type="preRenderView" />
		</f:metadata>
	</ui:define>

	<ui:define name="conteudo">

		<h:form id="form1">
			<p:panel header="Consultar">
				<h:panelGrid columns="4" cellpadding="5">
					<p:outputLabel for="instancia" value="Instância:" />
					<p:inputText id="instancia"
						value="#{operacionalBean.cliente.instancia}"
						placeholder="Instância..." />
					<p:commandButton action="#{operacionalBean.consultar()}"
						update="@all" value="Consultar">
						<f:ajax execute="@form" render="@all">
							<p:ajaxStatus onstart="PF('statusDialog').show()"
								onsuccess="PF('statusDialog').hide()" />
						</f:ajax>
					</p:commandButton>
					<p:message for="instancia" />

					<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
						closable="false" resizable="false" showHeader="false">
						<h:graphicImage value="/recursos/images/loading.gif" />
					</p:dialog>
				</h:panelGrid>
			</p:panel>
			<h:messages for="form1" />
		</h:form>

		<h:form id="form2">
			<p:panel header="Configurações Linha" style="margin-top: 15px"
				rendered="#{not empty operacionalBean.cliente.linha.instancia}">
				
				<div class="ui-grid ui-grid-responsive">
					<div class="ui-grid-row">
						<div class="ui-grid-col-3">

							<p:panelGrid columns="2" cellpadding="10"
								style="margin-top: 15px">

								<f:facet name="header">
											Informações da Central
										</f:facet>
								<h:outputText value="Instância:" />
								<h:outputText id="instancia"
									value="#{operacionalBean.cliente.linha.instancia}" />

								<h:outputText value="Tipo da Central:" />
								<h:outputText value="#{operacionalBean.cliente.linha.nome}" />

								<h:outputText value="Central:" />
								<h:outputText
									value="#{operacionalBean.cliente.linha.infoSwitch.switchName}" />
							</p:panelGrid>


						</div>
						<div class="ui-grid-col-9">
							<p:dataTable var="conf" style="margin-top: 15px"
								emptyMessage="Configurações não encontradas"
								value="#{operacionalBean.cliente.linha.configuracao.parametros}">

								<f:facet name="header">Configurações #{operacionalBean.cliente.linha.nome}</f:facet>

								<p:column headerText="Nome">
									<h:outputText value="#{conf.nome}" />
								</p:column>
								<p:column headerText="Valor">
									<h:outputText value="#{conf.valor}" />
								</p:column>
							</p:dataTable>
						</div>
					</div>
				</div>
				<p:dataTable var="error" type="unordered" style="margin-top: 15px"
					rendered="#{operacionalBean.cliente.linha.configErrors.size() > 0}"
					value="#{operacionalBean.cliente.linha.configErrors}"
					emptyMessage="NÃ£o foram encontrados erros de Configuração.">

					<p:column headerText="Erros de Configuração">
						<h:outputText value="#{error}" />
					</p:column>

				</p:dataTable>
				<h:panelGroup layout="block"
					rendered="#{operacionalBean.cliente.linha.configErrors.size() == 0}">
					<div class="alert alert-success" style="margin-top: 15px">
						<h3>Não foram encontrados erros lógicos de configuração!</h3>
					</div>
				</h:panelGroup>
				
				<h:commandButton value="Realizar Correções!"
					action="#{operacionalBean.realizarCorrecoesLinha()}" style="margin-top: 15px">
					<f:ajax execute="@form" render="@form" />
				</h:commandButton>

			</p:panel>
		</h:form>


	</ui:define>
</ui:composition>
</html>